{"ast":null,"code":"const url = require('url');\nconst qs = require('qs');\nconst {\n  ParameterError,\n  NotFoundError\n} = require('./errors');\nconst {\n  Store,\n  Presenter\n} = require('yayson')();\nconst store = new Store();\nconst presenters = require('./presenters');\nmodule.exports = function ({\n  apiKey,\n  fetch,\n  apiHost,\n  apiProtocol\n} = {}) {\n  const httpRequest = async function (method, options) {\n    let {\n      path,\n      json,\n      filter,\n      include,\n      sort,\n      page,\n      raw,\n      type\n    } = options;\n    const API_HOST = options.apiHost || apiHost || process.env.CONFETTI_API_HOST || 'api.confetti.events';\n    const API_PROTOCOL = options.apiProtocol || apiProtocol || process.env.CONFETTI_API_PROTOCOL || 'https';\n    let API_KEY = options.apiKey || apiKey;\n    let fetchLib = options.fetch || fetch;\n    if (!fetchLib) {\n      fetchLib = require('node-fetch');\n    }\n    if (!API_KEY) {\n      throw new Error('missing_api_key');\n    }\n    if (Array.isArray(include)) {\n      include = encodeURI(include.join(','));\n    }\n    const httpOptions = {\n      method,\n      timeout: method === 'get' ? 5000 : 15000,\n      headers: {\n        Authorization: `apikey ${API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept-Encoding': 'gzip'\n      }\n    };\n    const fetchUrl = url.format({\n      host: API_HOST,\n      protocol: API_PROTOCOL,\n      pathname: path,\n      search: qs.stringify({\n        filter,\n        sort,\n        page,\n        include\n      })\n    });\n    if (json) {\n      const presented = presenters[type].render(json);\n      const meta = presented?.data?.attributes?.meta;\n      if (meta) {\n        presented.data.meta = meta;\n        delete presented.data.attributes.meta;\n      }\n      httpOptions.body = JSON.stringify(presented);\n    }\n    const res = await fetchLib(fetchUrl, httpOptions);\n    if (res.status >= 200 && res.status < 299) {\n      const contentType = res.headers.get('content-type') || '';\n      if (contentType.includes('application/json')) {\n        const body = await res.json();\n        if (raw) {\n          return body;\n        } else {\n          return store.sync(body);\n        }\n      } else {\n        return await res.text();\n      }\n    } else {\n      let errorBody;\n      if (res.status >= 400 && res.status < 499) {\n        const contentType = res.headers.get('content-type') || '';\n        if (contentType.includes('application/json')) {\n          errorBody = await res.json();\n        } else {\n          errorBody = await res.text();\n        }\n      }\n      if (res.status == 400) {\n        throw new ParameterError('validation', errorBody);\n      } else if (res.status == 404) {\n        throw new NotFoundError(errorBody.message || 'object', errorBody);\n      } else {\n        throw new Error();\n      }\n    }\n  };\n  const adapter = {\n    async put(options) {\n      return await httpRequest('put', options);\n    },\n    async post(options) {\n      return await httpRequest('post', options);\n    },\n    async get(options) {\n      return await httpRequest('get', options);\n    },\n    async delete(options) {\n      return await httpRequest('delete', options);\n    }\n  };\n  return adapter;\n};","map":{"version":3,"names":["url","require","qs","ParameterError","NotFoundError","Store","Presenter","store","presenters","module","exports","apiKey","fetch","apiHost","apiProtocol","httpRequest","method","options","path","json","filter","include","sort","page","raw","type","API_HOST","process","env","CONFETTI_API_HOST","API_PROTOCOL","CONFETTI_API_PROTOCOL","API_KEY","fetchLib","Error","Array","isArray","encodeURI","join","httpOptions","timeout","headers","Authorization","fetchUrl","format","host","protocol","pathname","search","stringify","presented","render","meta","data","attributes","body","JSON","res","status","contentType","get","includes","sync","text","errorBody","message","adapter","put","post","delete"],"sources":["C:/Users/ASUS/Desktop/OFPPT 2023-2024/Mechbook/React-Redux/tennis-App/tennis-app/node_modules/confetti/src/adapter.js"],"sourcesContent":["const url = require('url')\nconst qs = require('qs')\n\nconst { ParameterError, NotFoundError } = require('./errors')\n\nconst { Store, Presenter } = require('yayson')()\nconst store = new Store()\n\nconst presenters = require('./presenters')\n\nmodule.exports = function ({ apiKey, fetch, apiHost, apiProtocol } = {}) {\n  const httpRequest = async function (method, options) {\n    let { path, json, filter, include, sort, page, raw, type } = options\n\n    const API_HOST =\n      options.apiHost ||\n      apiHost ||\n      process.env.CONFETTI_API_HOST ||\n      'api.confetti.events'\n\n    const API_PROTOCOL =\n      options.apiProtocol || apiProtocol || process.env.CONFETTI_API_PROTOCOL || 'https'\n\n    let API_KEY = options.apiKey || apiKey\n    let fetchLib = options.fetch || fetch\n\n    if (!fetchLib) {\n      fetchLib = require('node-fetch')\n    }\n    if (!API_KEY) {\n      throw new Error('missing_api_key')\n    }\n    if (Array.isArray(include)) {\n      include = encodeURI(include.join(','))\n    }\n\n    const httpOptions = {\n      method,\n      timeout: method === 'get' ? 5000 : 15000,\n      headers: {\n        Authorization: `apikey ${API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept-Encoding': 'gzip',\n      },\n    }\n    const fetchUrl = url.format({\n      host: API_HOST,\n      protocol: API_PROTOCOL,\n      pathname: path,\n      search: qs.stringify({ filter, sort, page, include }),\n    })\n    if (json) {\n      const presented = presenters[type].render(json)\n\n      const meta = presented?.data?.attributes?.meta\n      if (meta) {\n        presented.data.meta = meta\n        delete presented.data.attributes.meta\n      }\n\n      httpOptions.body = JSON.stringify(presented)\n    }\n\n    const res = await fetchLib(fetchUrl, httpOptions)\n\n    if (res.status >= 200 && res.status < 299) {\n      const contentType = res.headers.get('content-type') || ''\n      if (contentType.includes('application/json')) {\n        const body = await res.json()\n        if (raw) {\n          return body\n        } else {\n          return store.sync(body)\n        }\n      } else {\n        return await res.text()\n      }\n    } else {\n      let errorBody\n      if (res.status >= 400 && res.status < 499) {\n        const contentType = res.headers.get('content-type') || ''\n        if (contentType.includes('application/json')) {\n          errorBody = await res.json()\n        } else {\n          errorBody = await res.text()\n        }\n      }\n      if (res.status == 400) {\n        throw new ParameterError('validation', errorBody)\n      } else if (res.status == 404) {\n        throw new NotFoundError(errorBody.message || 'object', errorBody)\n      } else {\n        throw new Error()\n      }\n    }\n  }\n\n  const adapter = {\n    async put(options) {\n      return await httpRequest('put', options)\n    },\n\n    async post(options) {\n      return await httpRequest('post', options)\n    },\n\n    async get(options) {\n      return await httpRequest('get', options)\n    },\n\n    async delete(options) {\n      return await httpRequest('delete', options)\n    },\n  }\n\n  return adapter\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}